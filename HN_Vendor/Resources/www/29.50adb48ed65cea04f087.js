(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{BNKp:function(e,t,n){"use strict";n.r(t);var o=n("CcnG"),i=n("H+bZ"),r=n("ajt+"),c=n("ZZ/e"),a=n("6mc2"),s=(n("XDpg"),function(){function e(e,t,n,o,i){this.tools=e,this.navCtrl=t,this.api=n,this.db=o,this.events=i,this.project=null,this.slidesOpts={speed:1e3,spaceBetween:10,autoplay:{delay:5e3},loop:!1,zoom:!0},this.que={},this.origin={},this.index=0,this.slidesList=[],this.slidesList=Object.assign([],JSON.parse(sessionStorage.getItem("annexs"))),this.index=JSON.parse(sessionStorage.getItem("index"))}return e.prototype.ngOnInit=function(){this.initSlide()},e.prototype.initSlide=function(){console.log("slidlist:====",this.slidesList),this.index>=0&&this.slide01.slideTo(this.index)},e.prototype.slideTouchEnd=function(){this.slide01.startAutoplay()},e.prototype.selectSlide=function(){this.slide01.getActiveIndex().then(function(e){console.log(e)})},e}()),u=function(){return function(){}}(),l=n("pMnS"),d=n("oBZk"),h=n("Ip0R"),p=o["\u0275crt"]({encapsulation:0,styles:[[".ion_slide[_ngcontent-%COMP%]{height:100%;width:100%}.list-ios[_ngcontent-%COMP%]{margin-bottom:10px}#scan_annex[_ngcontent-%COMP%]{font-size:12px;color:gray}"]],data:{}});function _(e){return o["\u0275vid"](0,[(e()(),o["\u0275eld"](0,0,null,null,2,"ion-slide",[["class","ion_slide"]],null,null,null,d.gb,d.A)),o["\u0275did"](1,49152,null,0,c.IonSlide,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(e()(),o["\u0275eld"](2,0,null,0,0,"img",[["style","width:100%;height:100%;"]],[[8,"src",4]],null,null,null,null))],null,function(e,t){e(t,2,0,t.context.$implicit.url)})}function m(e){return o["\u0275vid"](0,[o["\u0275qud"](402653184,1,{slide01:0}),(e()(),o["\u0275eld"](1,0,null,null,11,"ion-header",[["no-border",""]],null,null,null,d.T,d.n)),o["\u0275did"](2,49152,null,0,c.IonHeader,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(e()(),o["\u0275eld"](3,0,null,0,9,"ion-toolbar",[["color","primary"]],null,null,null,d.kb,d.E)),o["\u0275did"](4,49152,null,0,c.IonToolbar,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],{color:[0,"color"]},null),(e()(),o["\u0275eld"](5,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,d.J,d.d)),o["\u0275did"](6,49152,null,0,c.IonButtons,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(e()(),o["\u0275eld"](7,0,null,0,2,"ion-back-button",[["default-href","home"]],null,[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==o["\u0275nov"](e,9).onClick(n)&&i),i},d.H,d.b)),o["\u0275did"](8,49152,null,0,c.IonBackButton,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),o["\u0275did"](9,16384,null,0,c.IonBackButtonDelegate,[[2,c.IonRouterOutlet],c.NavController],null,null),(e()(),o["\u0275eld"](10,0,null,0,2,"ion-title",[],null,null,null,d.jb,d.D)),o["\u0275did"](11,49152,null,0,c.IonTitle,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(e()(),o["\u0275ted"](-1,0,["\u95ee\u9898\u76f8\u5173\u9644\u4ef6"])),(e()(),o["\u0275eld"](13,0,null,null,5,"ion-content",[],null,null,null,d.P,d.j)),o["\u0275did"](14,49152,null,0,c.IonContent,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(e()(),o["\u0275eld"](15,0,null,0,3,"ion-slides",[["pager","true"]],null,[[null,"ionSlideTouchEnd"],[null,"ionSlideTap"]],function(e,t,n){var o=!0,i=e.component;return"ionSlideTouchEnd"===t&&(o=!1!==i.slideTouchEnd()&&o),"ionSlideTap"===t&&(o=!1!==i.selectSlide()&&o),o},d.hb,d.B)),o["\u0275did"](16,49152,[[1,4],["slide01",4]],0,c.IonSlides,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],{options:[0,"options"],pager:[1,"pager"]},null),(e()(),o["\u0275and"](16777216,null,0,1,null,_)),o["\u0275did"](18,278528,null,0,h.NgForOf,[o.ViewContainerRef,o.TemplateRef,o.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],function(e,t){var n=t.component;e(t,4,0,"primary"),e(t,16,0,n.slidesOpts,"true"),e(t,18,0,n.slidesList)},null)}function b(e){return o["\u0275vid"](0,[(e()(),o["\u0275eld"](0,0,null,null,1,"app-scan-annexs",[],null,null,null,m,p)),o["\u0275did"](1,114688,null,0,s,[a.a,c.NavController,i.a,r.a,c.Events],null,null)],function(e,t){e(t,1,0)},null)}var f=o["\u0275ccf"]("app-scan-annexs",s,b,{},{},[]),g=n("gIcY"),y=n("ZYCi");n.d(t,"ScanAnnexsPageModuleNgFactory",function(){return v});var v=o["\u0275cmf"](u,[],function(e){return o["\u0275mod"]([o["\u0275mpd"](512,o.ComponentFactoryResolver,o["\u0275CodegenComponentFactoryResolver"],[[8,[l.a,f]],[3,o.ComponentFactoryResolver],o.NgModuleRef]),o["\u0275mpd"](4608,h.NgLocalization,h.NgLocaleLocalization,[o.LOCALE_ID,[2,h["\u0275angular_packages_common_common_a"]]]),o["\u0275mpd"](4608,g["\u0275angular_packages_forms_forms_j"],g["\u0275angular_packages_forms_forms_j"],[]),o["\u0275mpd"](4608,c.AngularDelegate,c.AngularDelegate,[o.NgZone,o.ApplicationRef]),o["\u0275mpd"](4608,c.ModalController,c.ModalController,[c.AngularDelegate,o.ComponentFactoryResolver,o.Injector]),o["\u0275mpd"](4608,c.PopoverController,c.PopoverController,[c.AngularDelegate,o.ComponentFactoryResolver,o.Injector]),o["\u0275mpd"](1073742336,h.CommonModule,h.CommonModule,[]),o["\u0275mpd"](1073742336,g["\u0275angular_packages_forms_forms_bc"],g["\u0275angular_packages_forms_forms_bc"],[]),o["\u0275mpd"](1073742336,g.FormsModule,g.FormsModule,[]),o["\u0275mpd"](1073742336,c.IonicModule,c.IonicModule,[]),o["\u0275mpd"](1073742336,y.n,y.n,[[2,y.t],[2,y.m]]),o["\u0275mpd"](1073742336,u,u,[]),o["\u0275mpd"](1024,y.k,function(){return[[{path:"",component:s}]]},[])])})},"H+bZ":function(e,t,n){"use strict";var o=n("sE5F"),i=n("6mc2"),r=n("kScs"),c=n("mrSG"),a=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.scheduler=t,o.work=n,o.pending=!1,o}return c.__extends(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,o=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(o,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,o=void 0;try{this.work(e)}catch(i){n=!0,o=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),o},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,o=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==o&&n.splice(o,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return c.__extends(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n("pugT").a)),s=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),u=new(function(e){function t(n,o){void 0===o&&(o=s.now);var i=e.call(this,n,function(){return t.delegate&&t.delegate!==i?t.delegate.now():o()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return c.__extends(t,e),t.prototype.schedule=function(n,o,i){return void 0===o&&(o=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,o,i):e.prototype.schedule.call(this,n,o,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(s))(a);function l(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}l.prototype=Object.create(Error.prototype);var d=l,h=n("MGBS"),p=n("zotm"),_=function(){function e(e,t,n,o){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=o}return e.prototype.call=function(e,t){return t.subscribe(new m(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),m=function(e){function t(t,n,o,i,r){var c=e.call(this,t)||this;return c.absoluteTimeout=n,c.waitFor=o,c.withObservable=i,c.scheduler=r,c.action=null,c.scheduleTimeout(),c}return c.__extends(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(Object(p.a)(e,t))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},t}(h.a),b=n("6blF");var f=n("CcnG");n.d(t,"a",function(){return y});var g="http://erp20-app.heneng.cn:16681",y=function(){function e(e,t){this.http=e,this.tools=t,this.count=0}return e.prototype.GET=function(e,t,n,i){var r=this;void 0===n&&(n="\u52a0\u8f7d\u4e2d..."),void 0===i&&(i=!0),i&&this.showLoading(n);var c=g+"/"+(e||""),a=(new Date).getTime().toString()+(1e3*Math.random()+1e3).toString(),s=this.generateAccessKey(a),u=new o.j;for(var l in u.set("i",a),u.set("ak",s),localStorage.getItem("token")&&u.set("token",localStorage.getItem("token")),t=t||{})t.hasOwnProperty(l)&&u.set(l,t[l]);return u.set("sign",this.signParams(t)),new Promise(function(e,t){r.http.get(c,new o.g({search:u})).toPromise().then(function(n){r.hideLoading();var o=r.handleSuccess(n);0===o.code?e(o):t(o)}).catch(function(e){r.hideLoading();var n=r.handleError(e);t(n)})})},e.prototype.POST=function(e,t,n,i){var r=this;void 0===n&&(n="\u52a0\u8f7d\u4e2d..."),void 0===i&&(i=!0),i&&this.showLoading(n),console.log("params:====",t);var c=g+"/"+(e||""),a=(new Date).getTime().toString()+(1e3*Math.random()+1e3).toString(),s=this.generateAccessKey(a);(t=t||{}).sign=this.signParams(t),t.i=a,t.ak=s,localStorage.getItem("token")&&(t.token=localStorage.getItem("token"));var u=new o.d({"Content-Type":"application/json"}),l=new o.g({headers:u});return new Promise(function(e,n){r.http.post(c,JSON.stringify(t),l).toPromise().then(function(t){r.hideLoading();var o=r.handleSuccess(t);0===o.code?e(o):n(o)}).catch(function(e){r.hideLoading();var t=r.handleError(e);r.tools.showToast(t.message),n(t)})})},e.prototype.upload=function(e,t,n){var o=this;return void 0===t&&(t="\u6b63\u5728\u63d0\u4ea4"),void 0===n&&(n=!0),n&&this.showLoading(t),new Promise(function(t,n){var i,r,c;o.http.post("http://erp20-app.heneng.cn:16681/upload",e,null).pipe((i=12e4,void 0===r&&(r=u),function(e,t,n){return void 0===n&&(n=u),function(o){var i,r=(i=e)instanceof Date&&!isNaN(+i),c=r?+e-n.now():Math.abs(e);return o.lift(new _(c,r,t,n))}}(i,(c=new d,new b.a(function(e){return e.error(c)})),r))).toPromise().then(function(e){o.hideLoading();var i=e.json();"0"===i.code?t(i):n(i)}).catch(function(e){o.hideLoading();var t=o.handleError(e);n(t)})})},e.prototype.handleSuccess=function(e){var t=e.json();return"0"===t.code?{code:0,total:t.rowcount,data:t.data}:(this.tools.showToast(t.codemsg),{code:parseInt(t.code.toString()),message:t.codemsg})},e.prototype.handleError=function(e){var t;if(e instanceof o.h){var n=e.json()||"",i=n.error||JSON.stringify(n);t=""+i=='{"isTrusted":true}'?"\u6ca1\u6709\u7f51\u7edc\u8fde\u63a5\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5~":e.status+" - "+(e.statusText||"")+" "+i}else t=e.message?e.message:e.toString();return{code:500,message:t}},e.prototype.signParams=function(e){if(!e)return null;var t=Object.keys(e).sort();if(0===t.length)return null;var n="";return t.forEach(function(t){n+=e[t]+":"}),r.Md5.hashStr(n,!1).toString()},e.prototype.generateAccessKey=function(e){return r.Md5.hashStr(""+e.toString(),!1).toString()},e.prototype.showLoading=function(e){1==++this.count&&this.tools.showLoading(e,"lines",12e4)},e.prototype.hideLoading=function(){0==--this.count&&this.tools.hideLoading().catch(function(e){})},e.ngInjectableDef=f.defineInjectable({factory:function(){return new e(f.inject(o.e),f.inject(i.a))},token:e,providedIn:"root"}),e}()},"ajt+":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n("sJLo"),i=n("CcnG"),r=function(){function e(){this.hasCreatedDB=!1}return e.prototype.getDBName=function(){var e=localStorage.getItem("db.name");return e||(e="qms_"+ +new Date,localStorage.setItem("db.name",e)),e},e.prototype.createDB=function(){var e=this;return new Promise(function(t,n){if(e.db)t(e.db);else{var o=window.indexedDB;if(o){console.log("open db");var i=o.open(e.getDBName(),4);i.onerror=function(e){console.log(e),n(e.target.error.message)},i.onsuccess=function(n){e.db=i.result,e.clearTable("check_itemlist"),t(e.db)},i.onupgradeneeded=function(t){if(console.log(2121),e.db=i.result,e.db.objectStoreNames.contains("add_que")||(n=e.db.createObjectStore("add_que",{keyPath:"addque_id",autoIncrement:!0})).createIndex("check_limit",["check_type","rect_limit"],{unique:!1}),e.db.objectStoreNames.contains("que_list")||((n=e.db.createObjectStore("que_list",{keyPath:"que_id",autoIncrement:!0})).createIndex("istate","istate",{unique:!1}),n.createIndex("checkup_id","checkup_id",{unique:!1}),n.createIndex("level_id","level_id",{unique:!1}),n.createIndex("time","reg_date",{unique:!1})),e.db.objectStoreNames.contains("que_list_annexs")||((n=e.db.createObjectStore("que_list_annexs",{keyPath:"que_annex_id",autoIncrement:!0})).createIndex("IdAndType",["problem_id","annex_type"],{unique:!1}),n.createIndex("TableAndType",["table_id","annex_type"],{unique:!1}),n.createIndex("ID","annex_id",{unique:!1})),e.db.objectStoreNames.contains("que_list_record")||(n=e.db.createObjectStore("que_list_record",{keyPath:"que_record_id",autoIncrement:!0})).createIndex("problemId","problem_id",{unique:!1}),!e.db.objectStoreNames.contains("que_list_contracttype"))var n=e.db.createObjectStore("que_list_contracttype",{keyPath:"que_contracttype_id",autoIncrement:!0});e.db.objectStoreNames.contains("que_level_list")||(n=e.db.createObjectStore("que_level_list",{keyPath:"que_level_id",autoIncrement:!0})),e.db.objectStoreNames.contains("task_list_1")||((n=e.db.createObjectStore("task_list_1",{keyPath:"task_1_id",autoIncrement:!0})).createIndex("isUpdate","isupdate",{unique:!1}),n.createIndex("iscomplete","iscomplete",{unique:!1}),n.createIndex("type_complete",["checkup_id","iscomplete"],{unique:!1})),e.db.objectStoreNames.contains("task_list_2")||((n=e.db.createObjectStore("task_list_2",{keyPath:"task_2_id",autoIncrement:!0})).createIndex("planMid","plan_mid",{unique:!1}),n.createIndex("isUpdate","isupdate",{unique:!1}),n.createIndex("type_isfq",["object_type","is_fq","plan_mid"],{unique:!1}),n.createIndex("parid_isfq",["tree_parid","is_fq","plan_mid"],{unique:!1})),e.db.objectStoreNames.contains("task_list_3")||((n=e.db.createObjectStore("task_list_3",{keyPath:"task_3_id",autoIncrement:!0})).createIndex("planDid","plan_did",{unique:!1}),n.createIndex("positionName","position_name",{unique:!1}),n.createIndex("isUpdate","isupdate",{unique:!1})),e.db.objectStoreNames.contains("project_tree")||((n=e.db.createObjectStore("project_tree",{keyPath:"tree_id",autoIncrement:!0})).createIndex("type_isfq",["object_type","is_fq"],{unique:!1}),n.createIndex("parid_isfq",["tree_parid","is_fq"],{unique:!1})),e.db.objectStoreNames.contains("list_inhouse")||(n=e.db.createObjectStore("list_inhouse",{keyPath:"listinhouse_id",autoIncrement:!0})).createIndex("objtypename","objecttype_name",{unique:!1}),e.db.objectStoreNames.contains("check_itemlist")||(n=e.db.createObjectStore("check_itemlist",{keyPath:"item_id",autoIncrement:!0})).createIndex("checkup_position",["checkup_id","pro_position_id"],{unique:!1}),e.db.objectStoreNames.contains("check_itemlist_new")||(n=e.db.createObjectStore("check_itemlist_new",{keyPath:"item_new_id",autoIncrement:!0})).createIndex("checkup_position_type",["checkup_id","position_id","template_type"],{unique:!1}),e.db.objectStoreNames.contains("check_typelist")||e.db.createObjectStore("check_typelist",{keyPath:"dic_id",autoIncrement:!1}),e.db.objectStoreNames.contains("que_type_item")||(n=e.db.createObjectStore("que_type_item",{keyPath:"que_type_item_id",autoIncrement:!0})).createIndex("position_id",["position_id"],{unique:!1}),e.db.objectStoreNames.contains("que_type_item")||(n=e.db.createObjectStore("que_type_item",{keyPath:"que_type_item_id",autoIncrement:!0})).createIndex("position_id",["position_id"],{unique:!1}),e.db.objectStoreNames.contains("account_list")||((n=e.db.createObjectStore("account_list",{keyPath:"account_id",autoIncrement:!0})).createIndex("accountType","accounttype",{unique:!1}),n.createIndex("companyName","companyname",{unique:!1}),n.createIndex("contractTypeId","contracttypeid",{unique:!1}),n.createIndex("contractId","contractid",{unique:!1})),e.db.objectStoreNames.contains("account_list_2")||((n=e.db.createObjectStore("account_list_2",{keyPath:"account_id",autoIncrement:!0})).createIndex("accountType","accounttype",{unique:!1}),n.createIndex("companyName","companyname",{unique:!1}),n.createIndex("contractTypeId","contracttypeid",{unique:!1}),n.createIndex("contractId","contractid",{unique:!1})),e.db.objectStoreNames.contains("accounttype_list")||(n=e.db.createObjectStore("accounttype_list",{keyPath:"accounttype_id",autoIncrement:!0})),e.db.objectStoreNames.contains("accounttype_list_2")||(n=e.db.createObjectStore("accounttype_list_2",{keyPath:"accounttype_id",autoIncrement:!0})),e.db.objectStoreNames.contains("que_reason_list")||(n=e.db.createObjectStore("que_reason_list",{keyPath:"que_reason_id",autoIncrement:!0})),e.db.objectStoreNames.contains("que_overdue_reason_list")||(n=e.db.createObjectStore("que_overdue_reason_list",{keyPath:"que_overdue_reason_id",autoIncrement:!0})),e.db.objectStoreNames.contains("rect_register_list")||(n=e.db.createObjectStore("rect_register_list",{keyPath:"rect_register_id",autoIncrement:!0})),e.db.objectStoreNames.contains("rect_feedback_list")||(n=e.db.createObjectStore("rect_feedback_list",{keyPath:"rect_feedback_id",autoIncrement:!0})),e.db.objectStoreNames.contains("rect_urge_list")||(n=e.db.createObjectStore("rect_urge_list",{keyPath:"rect_urge_id",autoIncrement:!0})),e.db.objectStoreNames.contains("rect_accept_list")||(n=e.db.createObjectStore("rect_accept_list",{keyPath:"rect_accept_id",autoIncrement:!0})),e.db.objectStoreNames.contains("check_type_list")||(n=e.db.createObjectStore("check_type_list",{keyPath:"check_type_id",autoIncrement:!0})).createIndex("parIdCheckType",["tree_parid","checkup_id"],{unique:!1}),e.db.objectStoreNames.contains("search_que_man_list")||(n=e.db.createObjectStore("search_que_man_list",{keyPath:"search_que_man_id",autoIncrement:!0})).createIndex("manname","manname",{unique:!1}),e.db.objectStoreNames.contains("search_que_con_list")||(n=e.db.createObjectStore("search_que_con_list",{keyPath:"search_que_con_id",autoIncrement:!0})).createIndex("conname","conname",{unique:!1}),e.db.objectStoreNames.contains("search_que_building_list")||(n=e.db.createObjectStore("search_que_building_list",{keyPath:"search_que_building_name",autoIncrement:!0})).createIndex("roomname","roomname",{unique:!1}),console.log(555)}}else n("\u6682\u4e0d\u652f\u6301\u6570\u636e\u7f13\u5b58")}})},e.prototype.initDB=function(){return this.createDB()},e.prototype.closeDB=function(){console.log("\u5173\u95ed\u6570\u636e\u5e93\uff1a"+this.db),this.db&&this.db.close()},e.prototype.deleteDB=function(){console.log("\u5220\u9664\u6570\u636e\u5e93\uff1a",this.db),window.indexedDB.deleteDatabase(this.getDBName()),localStorage.removeItem("db.name"),this.db=null},e.prototype.clearTable=function(e){console.log("\u6e05\u9664\u8868\uff1a"+e),this.db.transaction([e],"readwrite").objectStore(e).clear()},e.prototype.insert=function(e,t,n,i){void 0===i&&(i=!1);var r=this.db.transaction([e],"readwrite").objectStore(e);i&&r.clear(),console.log("\u63d2\u5165\u6570\u636e\uff1a"+e);var c=[],a=[],s=[],u=0;if(t.forEach(function(o){if("que_list"===e){var i=Object.assign({},o);c.push({conid:i.contracttypeid,conname:i.contracttypename}),a.push({manid:i.reg_manid,manname:i.reg_manname}),s.push({roomname:i.roomname})}var l=r.add(o);l.onsuccess=function(e){++u===t.length&&n&&n()},l.onerror=function(e){++u===t.length&&n&&n()}}),"que_list"===e){console.log(c),console.log(a),console.log(s);var l=this.db.transaction("search_que_con_list","readwrite").objectStore("search_que_con_list");l.clear();var d=this.db.transaction("search_que_man_list","readwrite").objectStore("search_que_man_list");d.clear();var h=this.db.transaction("search_que_building_list","readwrite").objectStore("search_que_building_list");h.clear(),c.sort(function(e,t){return e.conname>t.conname?1:-1}),a.sort(function(e,t){return e.manname>t.manname?1:-1}),s.sort(function(e,t){return e.roomname>t.roomname?1:-1}),o.a.unique_conid(c).forEach(function(e){l.add(e)}),o.a.unique_manid(a).forEach(function(e){d.add(e)}),o.a.unique_roomname(s).forEach(function(e){h.add(e)})}},e.prototype.delete=function(e,t,n){void 0===t&&(t=[]);var o=this.db.transaction([e],"readwrite").objectStore(e),i=[],r=[];t.forEach(function(e){var t=o.delete(e),n=new Promise(function(n,o){t.onsuccess=function(t){r.push(e)},t.onerror=function(e){}});i.push(n)}),Promise.all(i).then(function(){n&&n(r)})},e.prototype.update=function(e,t,n){void 0===t&&(t=[]);var o=this.db.transaction([e],"readwrite").objectStore(e),i=0;t.forEach(function(e){var r=o.put(e);r.onsuccess=function(e){++i===t.length&&n&&n()},r.onerror=function(e){}})},e.prototype.select=function(e,t,n,o){void 0===t&&(t=[]),void 0===n&&(n={}),void 0===o&&(o=null),console.log(e);var i=this.db.transaction([e],"readwrite").objectStore(e);if(0===t.length){var r=[];i.openCursor().onsuccess=function(e){var t=e.target.result;t?(r.push(t.value),t.continue()):o&&o(r)}}},e.prototype.getBuildings=function(e,t,n,o,i,r){void 0===t&&(t=null),void 0===n&&(n=0);var c="0"===i?"project_tree":"task_list_2";"1"==e?this.getSingleCondData(c,"type_isfq",0==n?"0"===i?["\u697c\u680b","0"]:["\u697c\u680b","0",r]:"0"===i?["\u5206\u533a","1"]:["\u5206\u533a","1",r],o):this.getSingleCondData(c,"parid_isfq","0"===i?[t,n.toString()]:[t,n.toString(),r],o)},e.prototype.getListInhouse=function(e,t){this.getSingleCondData("task_list_3","planDid",e,t)},e.prototype.getPartialsInHouse=function(e,t,n){this.getSingleCondData("check_itemlist","checkup_position",[e,t],n)},e.prototype.getPartialsInHouse2=function(e,t,n,o){this.getSingleCondData("check_itemlist_new","checkup_position_type",[t,n,e],o)},e.prototype.getSingleCondData=function(e,t,n,o){console.info(e,"-",t,"-",n);var i=this.db.transaction([e],"readwrite").objectStore(e).index(t),r=IDBKeyRange.only(n),c=i.openCursor(r);c.onerror=function(e){console.log(e.target.error.message),o&&o(null)};var a=[];c.onsuccess=function(e){var t=e.target.result;t?(a.push(t.value),t.continue()):o&&o(a)}},e.prototype.disposeDB=function(){var e=this;return new Promise(function(t){e.db.close(),window.indexedDB.deleteDatabase(e.getDBName()),t()})},e.ngInjectableDef=i.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}()}}]);